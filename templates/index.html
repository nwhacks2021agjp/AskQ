<html>
  <head>
    <title>Chat: {{ room }}</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.socket.io/socket.io-3.0.1.min.js"></script>
    <script type="text/javascript" charset="utf-8">
      var socket;
      $(document).ready(function(){
        socket = io.connect('http://' + document.domain + ':' + location.port + '/chat');
        socket.on('connect', function() {
          socket.emit('joined', {});
        });
        socket.on('message', function() {
          $('#chat').val($('#chat').val() + data.msg + '\n');
          $('#chat').scrollTop($('#chat')[0].scrollHeight);
        });
        $('#text').keypress(function (e) {
          var code = e.keyCode || e.which;
          if(code == 13) {
            text = $('#text').val();
            $('#text').val('');
            socket.emit('text', {msg: text});
          }
        })
      });
    </script>
  </head>
  <body>
    <h1>Flask-SocketIO-Chat: {{ room }}</h1>
    <textarea id="chat" cols="80" rows="20"></textarea><br><br>
    <input id="text" size="80" placeholder="Enter your message here"><br><br>
    <a href="#" onclick="leave_room();">Leave this room</a>
  </body>
</html>